!function($,window){"use strict";function stringRepeat(s,precision){return String.prototype.repeat?s.repeat(precision):(precision=precision||1,new Array(precision+1).join(s))}var pluginName="imagesCompare",defaults={initVisibleRatio:.5,interactionMode:"drag",animationDuration:400,animationEasing:"swing",addSeparator:!0,addDragHandle:!0,precision:4};function ImagesCompare(element,options){element=$(element),(options=$.extend({},defaults,options)).roundFactor=parseInt("1"+stringRepeat("0",options.precision)),this._name=pluginName;var frontElement,backElement,separator,dragHandle,lastRatio=1,size={width:0,height:0,maxWidth:0,maxHeight:0},events={initialised:"imagesCompare:initialised",changed:"imagesCompare:changed",resized:"imagesCompare:resized"};function onImagesLoaded(){var images=element.find("img"),totalImagesCount=images.length,elementsLoaded=0;function onImageLoaded(){elementsLoaded>=totalImagesCount&&init()}images.each((function(){$(this)[0].complete?(totalImagesCount--,onImageLoaded()):($(this).on("load",(function(){elementsLoaded++,onImageLoaded()})),$(this).on("error",(function(){elementsLoaded++,onImageLoaded()})))}))}function init(){updateDom(),patchSize(),initInteractions(),$(frontElement).attr("ratio",options.initVisibleRatio),setVisibleRatio(options.initVisibleRatio),element.trigger({type:events.initialised})}function addResize(){$(window).on("resize",(function(event){frontElement.css("clip",""),patchSize(),setVisibleRatio(lastRatio),element.trigger({type:events.resized,originalEvent:event})}))}function initInteractions(){switch(options.interactionMode=options.interactionMode.toLowerCase(),"drag"!=options.interactionMode&&"mousemove"!=options.interactionMode&&"click"!=options.interactionMode&&console.warn('No valid interactionMode found, valid values are "drag", "mousemove", "click"'),options.interactionMode){case"drag":initDrag();break;case"mousemove":initMouseMove();break;case"click":initClick();break;default:initDrag()}}function initDrag(){"undefined"==typeof Hammer&&console.error("Please include the hammerjs library for drag support"),addDrag(),addResize()}function initMouseMove(){addMouseMove(),addResize()}function initClick(){addClick(),addResize()}function addClick(){element.on("click",(function(event){var ratio;setVisibleRatio(getElementRatio(event.pageX))}))}function addMouseMove(){var lastMove=0,eventThrottle=1;element.on("mousemove",(function(event){event.preventDefault();var now=Date.now(),ratio;now>lastMove+1&&(lastMove=now,setVisibleRatio(getElementRatio(event.pageX)))})),element.on("mouseout",(function(event){var ratio;setVisibleRatio(getElementRatio(event.pageX))}))}function addDrag(){var hammertime=new Hammer(element[0]);hammertime.get("pan").set({direction:Hammer.DIRECTION_HORIZONTAL}),hammertime.on("pan",(function(event){var ratio;setVisibleRatio(getElementRatio(event.srcEvent.pageX))}))}function updateDom(){element.addClass("images-compare-container"),element.css("display","inline-block"),frontElement=element.find("> *:nth-child(1)"),backElement=element.find("> *:nth-child(2)"),frontElement.addClass("images-compare-before"),frontElement.css("display","block"),backElement.addClass("images-compare-after"),backElement.css("display","block"),options.addDragHandle&&buildDragHandle(),options.addSeparator&&buildSeparator()}function buildSeparator(){element.prepend("<div class='images-compare-separator'></div>"),separator=element.find(".images-compare-separator")}function buildDragHandle(){element.prepend("<div class='images-compare-handle'></div>"),(dragHandle=element.find(".images-compare-handle")).append("<span class='images-compare-left-arrow'></span>"),dragHandle.append("<span class='images-compare-right-arrow'></span>")}function patchSize(){var imgRef=backElement.find("img").first();setSize(imgRef.width(),imgRef.height(),imgRef.naturalWidth(),imgRef.naturalHeight()),element.css("max-width",size.maxWidth+"px"),element.css("max-height",size.maxHeight+"px"),frontElement.width(size.width),frontElement.height(size.height)}function getElementRatio(x){return roundRatio((x-element.offset().left)/frontElement.width())}function roundRatio(ratio){return(ratio=Math.round(ratio*options.roundFactor)/options.roundFactor)>1&&(ratio=1),ratio<0&&(ratio=0),ratio}function launchAnimation(startValue,endValue,duration,easing){$(frontElement).attr("ratio",startValue).animate({ratio:startValue},{duration:0}),$(frontElement).stop().attr("ratio",startValue).animate({ratio:endValue},{duration:duration,easing:easing,step:function(now){var width=getRatioValue(now);lastRatio=now,frontElement.attr("ratio",now).css("clip","rect(0, "+width+"px, "+size.height+"px, 0)"),options.addSeparator&&separator.css("left",width+"px"),options.addDragHandle&&dragHandle.css("left",width+"px")},done:function(animation,jumpedToEnd){var ratio=$(frontElement).attr("ratio");element.trigger({type:events.changed,ratio:ratio,value:getRatioValue(ratio),animate:!0,animation:animation,jumpedToEnd:jumpedToEnd})}})}function getRatioValue(ratio){return ratio=Math.round(ratio*options.roundFactor)/options.roundFactor,Math.round(frontElement.width()*ratio)}function setVisibleRatio(ratio,animate,duration,easing){void 0===animate&&(animate=!1);var width=getRatioValue(ratio);if(animate){var finalDuration=duration||options.animationDuration,finalEasing=easing||options.animationEasing;return launchAnimation(lastRatio,ratio,finalDuration,finalEasing),void(lastRatio!=ratio&&element.trigger({type:events.changed,ratio:lastRatio,value:width,animate:animate}))}frontElement.stop().css("clip","rect(0, "+width+"px, "+size.height+"px, 0)"),options.addSeparator&&$(separator).stop().css("left",width+"px"),options.addDragHandle&&dragHandle.css("left",width+"px"),lastRatio!=ratio&&element.trigger({type:events.changed,ratio:ratio,value:width,animate:animate}),lastRatio=ratio}function setSize(width,height,maxWidth,maxHeight){return void 0!==width&&setWidth(width),void 0!==height&&setHeight(height),void 0!==maxWidth&&setMaxWidth(maxWidth),void 0!==maxHeight&&setMaxHeight(maxHeight),size}function setWidth(width){return size.width=width,size}function setMaxWidth(maxWidth){return size.maxWidth=maxWidth,size}function setHeight(height){return size.height=height,size}function setMaxHeight(maxHeight){return size.maxHeight=maxHeight,size}return onImagesLoaded(),{setValue:function(ratio,animate,duration,easing){return setVisibleRatio(ratio,animate,duration,easing),element},getValue:function(){return lastRatio},on:function(eventName,callback){return element.on(eventName,callback),element},off:function(eventName,callback){return element.off(eventName,callback),element},events:function(){return events}}}$.fn.imagesCompare=function(userOptions){var options=$.extend(defaults,userOptions);return this.each((function(){$.data(this,pluginName)||$.data(this,pluginName,new ImagesCompare(this,options))}))}}(jQuery,window,document),function($){var props=["Width","Height"],prop,propsLength;propsLength=props.length;for(var index=0;index<propsLength;index++)!function(natural,prop){$.fn[natural]=natural in document.createElement("img")?function(){return this[0][natural]}:function(){var node=this[0],img,value=0;return"img"===node.tagName.toLowerCase()&&((img=document.createElement("img")).src=node.src,value=img[prop]),value}}("natural"+(prop=props[index]),prop.toLowerCase())}(jQuery);